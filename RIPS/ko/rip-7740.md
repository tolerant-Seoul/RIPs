---
rip: 7740
title: 결정론적 배포 팩토리 사전 설치
description: 결정론적 컨트랙트 배포를 가능하게 하는 공통 주소에 배포 팩토리 컨트랙트 추가 제안
author: Richard Meissner (@rmeissner), Mikhail Mikheev (@mmv08), Nicholas Rodrigues Lordello (@nlordell)
discussions-to: https://ethereum-magicians.org/t/rrc-7740-add-pre-installs-for-deployment-factories/22544
status: Draft
type: Standards Track
category: RRC
created: 2024-06-24
---

## 개요

이 제안은 공통 주소에 사전 설치될 배포 팩토리 컨트랙트 집합을 도입합니다. 이를 통해 서로 다른 네트워크에서 동일한 주소로 결정론적 컨트랙트 배포가 가능해집니다.

## 동기

많은 프로젝트가 배포의 보안과 결정론성을 높이기 위해 `create2`를 사용하는 배포 팩토리에 의존합니다. `create2`를 활용하면 몇 가지 주요 이점이 있습니다:
- 주소가 배포 키에 의존하지 않으므로 배포 키를 관리할 필요가 줄어듭니다
- 컨트랙트 주소가 배포 코드에 연결되어 배포된 코드에 대한 강력한 보장을 제공합니다
- selfdestruct 시 컨트랙트를 재배포할 수 있습니다

단점은 이러한 배포 팩토리를 배포해야 한다는 것입니다. 이를 수행하는 두 가지 일반적인 방법이 있습니다:
- 고정 배포 트랜잭션에 대해 무작위로 생성된 서명 활용
- 배포 팩토리를 위한 배포 키 관리.

고정 배포 트랜잭션에 대해 무작위로 생성된 서명을 사용하면 완전히 신뢰할 수 없는 프로세스이며 배포 키를 관리할 필요가 없다는 장점이 있습니다. 그러나 서명된 배포 트랜잭션의 매개변수를 변경할 수 없으므로 가스 가격, 가스 한도를 조정하거나 체인 ID를 설정할 수 없습니다.

결정론적이고 신뢰할 수 있는 배포를 위한 안정적인 방법을 제공하는 것은 EIP-7702와 같은 EIP에서 더욱 중요해질 것입니다. 이 EIP는 특정 주소의 코드에 의존하므로 배포 팩토리가 제공하는 강력한 보장이 매우 유용합니다.

이 RIP는 결정론적 배포 팩토리 집합에 대한 합의를 제안하고 개발자가 이러한 라이브러리에 의존할 수 있도록 모든 롤업에 사전 설치합니다. Optimism과 같은 일부 롤업은 이미 결정론적 배포를 위한 사전 설치된 컨트랙트 집합을 가지고 있으며, 이 제안은 파편화를 방지하기 위해 이 집합을 다른 롤업 스택으로 확장하는 것을 목표로 합니다.

## 사양

### 팩토리

다음 팩토리를 추가해야 합니다:
 - [Deterministic Deployment Proxy](https://github.com/Arachnid/deterministic-deployment-proxy) - `0x4e59b44847b379578588920ca78fbf26c0b4956c`
 - [Safe Singleton Factory](https://github.com/safe-global/safe-singleton-factory) - `0x914d7Fec6aaC8cd542e72Bca78B30650d45643d7`
 - [CreateX](https://github.com/pcaversaccio/createx) - `0xba5Ed099633D3B313e4D5F7bdc1305d3c28ba5Ed`
 - [Create2 Deployer](https://github.com/pcaversaccio/create2deployer) - `0x13b0D85CcB8bf860b6b79AF3029fCA081AE9beF2`

관리 키가 있는 팩토리의 경우, 팩토리가 파괴할 수 없고 충돌 시 CREATE 옵코드가 [되돌려지므로](https://eips.ethereum.org/EIPS/eip-684) 배포자 계정의 논스는 그대로 유지되어야 합니다.

### 참조

- [OP Stack 사전 설치](https://docs.optimism.io/builders/chain-operators/features/preinstalls)

## 근거

### 왜 하나의 팩토리에 맞추지 않나요?

나열된 팩토리는 이미 여러 네트워크에서 활발히 사용되고 있습니다. 기존 컨트랙트를 재배포할 필요 없이 향후 호환성을 보장하려면 기존 생태계의 많은 부분을 커버하는 배포 팩토리 집합을 활성화하는 것이 가장 합리적입니다.

## 하위 호환성

발생할 가능성이 낮은 잠재적 문제 중 하나는 악의적인 행위자가 키 관리 팩토리 중 하나의 배포자 키에 접근하여 제안의 영향을 받는 네트워크 중 하나에 팩토리 주소에 다른 바이트코드를 배포하는 것입니다. 이것이 제안이 구현되기 전에 발생하면 저자들은 두 가지 잠재적 해결책을 제안합니다:
- 팩토리 목록 재검토
- 주소의 코드 덮어쓰기.

다른 하위 호환성 문제는 발견되지 않았습니다.
